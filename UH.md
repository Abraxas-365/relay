# Fact√∫raMelo - Descripci√≥n del Proyecto

**Fact√∫raMelo** es una **plataforma integral de automatizaci√≥n y protecci√≥n de gesti√≥n de facturas** dise√±ada para empresas en **Latinoam√©rica y Europa**. El sistema se integra directamente con los sistemas tributarios locales (SUNAT en Per√∫, SAT en M√©xico, SII en Chile, AFIP en Argentina, etc.) proporcionando una soluci√≥n completa para el procesamiento, validaci√≥n y gesti√≥n de facturas electr√≥nicas.

## üéØ Objetivo Principal

Automatizar completamente el ciclo de vida de la gesti√≥n contable y **proteger a las empresas contra fraudes** comunes en la facturaci√≥n electr√≥nica, incluyendo:

### **Protecci√≥n Contra Fraude**
- **Fraude por "silencio administrativo"**: En muchos pa√≠ses de LATAM, si no rechazas una factura dentro de un plazo legal (8 d√≠as en Per√∫, var√≠a por pa√≠s), se considera autom√°ticamente aceptada. Los estafadores emiten facturas falsas y esperan que pase el plazo.
- **Doble cobro**: Proveedores que presentan la misma factura m√∫ltiples veces o la venden a factoring y luego la cobran directamente.
- **Facturas fantasma**: Facturas emitidas en el sistema tributario pero nunca notificadas al comprador.
- **Servicios no prestados**: Facturas por mercader√≠a nunca entregada o servicios nunca realizados.

### **Automatizaci√≥n Completa**
- **Descarga autom√°tica** desde sistemas tributarios oficiales
- **Validaci√≥n en tiempo real** con autoridades fiscales
- **Notificaciones inteligentes** a las √°reas correspondientes
- **Gesti√≥n de proveedores confiables**
- **Flujos de aprobaci√≥n automatizados**
- **Cumplimiento tributario** autom√°tico por pa√≠s

## üèóÔ∏è Arquitectura del Sistema por Dominios

El sistema est√° construido siguiendo **Domain-Driven Design** con los siguientes dominios:

### **üîê IAM Domain** (Gesti√≥n de Identidad y Acceso)

#### **Users (Usuarios)**
- Registro y autenticaci√≥n OAuth (Google Workspace, Microsoft 365, Auth0)
- Gesti√≥n de perfiles y preferencias
- Sistema de invitaciones por email
- Estados de usuario (pendiente, activo, inactivo, suspendido)
- Tracking de sesiones y auditor√≠a de accesos

#### **Tenants (Empresas/Multi-tenancy)**
- Aislamiento completo de datos por empresa
- Validaci√≥n de n√∫meros fiscales (RUC, RFC, NIT, CUIT, etc.) seg√∫n pa√≠s
- Gesti√≥n de suscripciones y planes
- L√≠mites por plan (usuarios, facturas/mes, integraciones)
- Configuraciones empresariales (branding, preferencias)

#### **Auth (Autenticaci√≥n)**
- Gesti√≥n de tokens JWT con claims personalizados
- Refresh tokens con rotaci√≥n autom√°tica
- Sesiones concurrentes y auto-logout por inactividad
- OAuth2 flow completo

#### **Roles (Control de Acceso)**
- **Roles predefinidos**: Admin Empresa, Contador, Compras, Aprobador por √Årea, Solo Lectura
- **Permisos granulares**: invoice.read, invoice.approve, supplier.manage, etc.
- **Roles personalizados** por empresa

---

### **üìÑ Invoices Domain** (Gesti√≥n de Facturas)

#### **Invoices (Facturas)**
- **Recepci√≥n autom√°tica**: Descarga directa desde sistemas tributarios cada hora
- **Recepci√≥n manual**: Upload de PDF/XML, recepci√≥n por email
- **OCR**: Digitalizaci√≥n de facturas f√≠sicas escaneadas
- **Validaci√≥n autom√°tica**:
  - Validaci√≥n fiscal en tiempo real
  - Verificaci√≥n de n√∫mero fiscal del proveedor
  - Detecci√≥n de duplicados (n√∫mero + proveedor + monto)
  - Validaci√≥n de formato seg√∫n est√°ndar del pa√≠s
- **Three-Way Matching**: Factura ‚Üî Orden de Compra ‚Üî Gu√≠a de Remisi√≥n
- **Estados del ciclo de vida**:
  - `PENDING_VENDOR_VERIFICATION` (reci√©n recibida)
  - `PENDING_APPROVAL` (validada, esperando aprobaci√≥n)
  - `APPROVED` (aprobada para pago)
  - `REJECTED` (rechazada con motivo)
  - `IN_DISPUTE` (en disputa con proveedor)
  - `CONTABILIZED` (contabilizada en el sistema)
- **Motor de reglas inteligente**:
  - Auto-aprobaci√≥n para proveedores confiables bajo cierto monto
  - Ruteo autom√°tico seg√∫n centro de costo/√°rea
  - Escalamiento por montos (>$10,000 ‚Üí Gerencia)
  - Alertas por patrones inusuales

#### **Attachments (Archivos Adjuntos)**
- Tipos soportados: PDF, XML (UBL/est√°ndar local), Gu√≠as de Remisi√≥n, √ìrdenes de Compra
- Validaci√≥n de tipos MIME y l√≠mites de tama√±o
- Antivirus scanning autom√°tico
- Extracci√≥n autom√°tica de datos (parser XML, OCR)
- Storage seguro en cloud con URLs firmadas

---

### **üì¶ Purchase Orders Domain** (√ìrdenes de Compra)

#### **Purchase Orders (√ìrdenes de Compra)**
- Generaci√≥n autom√°tica de n√∫meros de orden
- Templates para √≥rdenes recurrentes
- **Estados**: DRAFT, PENDING_APPROVAL, APPROVED, PARTIALLY_RECEIVED, COMPLETED, CANCELED
- Workflow de aprobaci√≥n configurable
- Integraci√≥n con proveedores (env√≠o autom√°tico por email)
- Portal para confirmaci√≥n de proveedores

#### **Items (L√≠neas de Orden)**
- Cat√°logo de productos/servicios maestro
- Gesti√≥n detallada de cantidades, precios y unidades
- Control de recepciones y entregas parciales
- Validaci√≥n autom√°tica contra facturas

---

### **üè¢ Suppliers/Vendors Domain** (Proveedores)

#### **Suppliers (Proveedores)**
- **Onboarding**: Registro con validaci√≥n autom√°tica de n√∫mero fiscal
- **Sistema de confiabilidad**:
  - **Proveedores de Confianza**: Auto-aprobaci√≥n hasta cierto monto
  - **Nuevos Proveedores**: Aprobaci√≥n manual obligatoria
  - **Lista Negra**: Proveedores bloqueados
  - Score din√°mico basado en historial
- **Estados**: PENDING_VERIFICATION, ACTIVE, SUSPENDED, BLACKLISTED
- **Gesti√≥n comercial**: T√©rminos de pago, l√≠mites de cr√©dito, descuentos
- **M√©tricas de performance**: Tiempo de entrega, cumplimiento, calidad

#### **Contacts (Contactos)**
- Tipos: PRIMARY, ACCOUNTING, PURCHASES, TECHNICAL, LEGAL, COMMERCIAL
- M√∫ltiples contactos por proveedor
- Comunicaci√≥n automatizada por tipo de contacto
- Validaci√≥n de informaci√≥n de contacto

#### **Supplier Portal (Portal de Proveedores)**
- Dashboard para proveedores con vista de √≥rdenes pendientes
- Confirmaci√≥n/rechazo de √≥rdenes de compra
- Upload directo de facturas
- Tracking de estado de procesamiento
- Mensajer√≠a directa con √°reas de compras

---

### **üèõÔ∏è Areas Domain** (Estructura Organizacional)

- Estructura jer√°rquica de departamentos y subdepartamentos
- Centros de costo y presupuestos por √°rea
- Ruteo inteligente de facturas seg√∫n reglas
- Gesti√≥n presupuestaria con alertas de sobregiros
- M√©tricas de eficiencia por √°rea

---

### **‚öôÔ∏è Workflows Domain** (Flujos de Trabajo)

- **Tipos de workflow**:
  - `SIMPLE`: Aprobaci√≥n de un solo nivel
  - `MULTI_LEVEL`: Aprobaci√≥n secuencial multinivel
  - `CONDITIONAL`: Basado en condiciones (monto, proveedor, etc.)
  - `PARALLEL`: M√∫ltiples aprobadores en paralelo
- **Workflows predefinidos**:
  - Aprobaci√≥n de facturas por monto y √°rea
  - Aprobaci√≥n de √≥rdenes de compra por jerarqu√≠a
  - Onboarding de proveedores
  - Resoluci√≥n de discrepancias
- Escalamiento autom√°tico por timeout
- Notificaciones inteligentes (Email/SMS/Push)

---

### **üîå Integrations Domain** (Integraciones)

#### **Sistemas Tributarios por Pa√≠s**
- **Per√∫**: SUNAT/SIRE
- **M√©xico**: SAT
- **Chile**: SII
- **Colombia**: DIAN
- **Argentina**: AFIP
- **Espa√±a**: AEAT
- **Y m√°s pa√≠ses de LATAM y Europa**

**Funcionalidades**:
- OAuth2 con credenciales fiscales por empresa
- Validaci√≥n en tiempo real
- Descarga autom√°tica de facturas electr√≥nicas
- Gesti√≥n de per√≠odos tributarios
- Reportes de validaci√≥n y cumplimiento
- Actualizaci√≥n de cr√©dito fiscal

#### **ERPs y Sistemas Contables**
- Conectores nativos: SAP, Oracle, Exact, Microsoft Dynamics
- APIs de sincronizaci√≥n bidireccional
- Mapeo de campos personalizable

#### **Bancos y Medios de Pago**
- Integraci√≥n con principales bancos de cada pa√≠s
- Detecci√≥n autom√°tica de pagos
- Conciliaci√≥n bancaria automatizada

#### **Servicios de Email**
- Procesamiento de facturas recibidas por email
- Env√≠o masivo de comunicaciones
- Templates responsive para notificaciones

---

## üí∞ Planes de Suscripci√≥n

| Plan | Precio | Facturas/mes | Usuarios | Caracter√≠sticas Principales |
|------|---------|--------------|----------|----------------------------|
| **B√°sico** | $0 | 15 | 1 | Aprobaci√≥n simple, base de conocimiento |
| **Profesional** | $29 | 150 | 3 | Hasta 5 √°reas, soporte email |
| **Negocios** | $149 | 400 | 10 | Aprobaci√≥n multinivel, hasta 15 √°reas, API b√°sica, chat prioritario |
| **Corporativo** | $450 | 1,000 | 25 | Validaci√≥n 3-v√≠as, OCR, IA para digitalizaci√≥n, API avanzada, soporte telef√≥nico |
| **Enterprise** | Desde $999 | 2,000+ | Ilimitados | IA avanzada (insights y detecci√≥n de anomal√≠as), conector nativo ERP, √°reas sincronizadas desde ERP, gerente de cuenta dedicado |

---

## üîë Ventajas Clave del Sistema

### **1. Cobertura 100% Autom√°tica**
Como todas las facturas son electr√≥nicas, Fact√∫raMelo las obtiene **DIRECTAMENTE** del sistema tributario oficial:
- ‚úÖ Capturas TODAS las facturas emitidas a tu n√∫mero fiscal
- ‚úÖ Detecci√≥n instant√°nea cuando alguien emite una factura
- ‚úÖ Sin depender de que el proveedor te las env√≠e
- ‚úÖ Imposible que una factura pase desapercibida

### **2. Protecci√≥n Contra Fraude por "Silencio"**
- üö® Detecta facturas antes que t√∫: Sistema las ve en el portal tributario y alerta de inmediato
- ‚è±Ô∏è Contador autom√°tico del plazo legal por pa√≠s
- üì± Notificaciones urgentes al responsable
- üìã Validaci√≥n autom√°tica:
  - ¬øTienes Orden de Compra? ‚Üí NO = üö® POSIBLE FRAUDE
  - ¬øRecibiste mercader√≠a? ‚Üí NO = üö® POSIBLE FRAUDE
  - ¬øConoces este gasto? ‚Üí NO = üö® ALERTA INMEDIATA
- ‚ùå Rechazo con un click: Genera carta formal y registra en sistema tributario
- üîê Nunca te sorprenden con facturas desconocidas

### **3. Eliminaci√≥n de Dobles Pagos**
- ‚úÖ Cross-check autom√°tico con autoridades fiscales
- üö´ Detecta duplicados: Mismo n√∫mero + proveedor = BLOQUEO AUTOM√ÅTICO
- üì¶ Three-way matching: Factura ‚Üî Orden de Compra ‚Üî Gu√≠a de Remisi√≥n
- üîç Verifica estado del proveedor en tiempo real

### **4. Historial Completo Descargado Autom√°ticamente**
- üìö TODAS tus facturas desde el sistema tributario
- üîç B√∫squeda instant√°nea por fecha, proveedor, monto, estado
- üíæ Archivos originales XML + PDF (100% auditable)
- üìä Reportes fiscales generados autom√°ticamente
- ‚è∞ Timeline completo con trazabilidad total

### **5. Aprobaci√≥n Inteligente por √Åreas**
- üìç Ruteo autom√°tico al √°rea/departamento correcto
- üì± Notificaci√≥n inmediata con plazo de acci√≥n
- üîç Validaciones inteligentes pre-aprobaci√≥n
- ‚è∞ Escalamiento autom√°tico si no hay respuesta
- üìù Trazabilidad completa de todas las acciones

### **6. Integraci√≥n con ERPs**
- üîó Exporta facturas validadas a SAP, Oracle, Exact, Dynamics, etc.
- ‚ö° Sincronizaci√≥n autom√°tica bidireccional
- üîå APIs REST para conectar cualquier sistema

---

## üöÄ Flujo Automatizado Completo

```
üèõÔ∏è Sistema Tributario Local (SUNAT/SAT/SII/AFIP/AEAT)
   ‚Üì (Sincronizaci√≥n cada hora)
ü§ñ Fact√∫raMelo descarga TODAS las facturas nuevas con tu n√∫mero fiscal
   ‚Üì
‚è∞ Sistema inicia contador autom√°tico (plazo legal del pa√≠s)
   ‚Üì
üîç Validaci√≥n instant√°nea:
   ‚úÖ ¬øExiste en el sistema tributario? (siempre s√≠)
   ‚ùå ¬øYa la pagaste? (detector de duplicados)
   ‚ùå ¬øHay Orden de Compra? ‚Üí NO = üö® ALERTA
   ‚ùå ¬øHay Gu√≠a de Remisi√≥n/Entrega? ‚Üí NO = üö® ALERTA
   ‚úÖ ¬øProveedor de confianza? ‚Üí Score de riesgo
   ‚Üì
üì± Notificaci√≥n INMEDIATA al √°rea responsable
   "‚ö†Ô∏è Nueva factura de [Proveedor] - $[Monto] - Quedan X d√≠as"
   ‚Üì
üë§ Responsable revisa en el dashboard:
   ‚Ä¢ Factura original (PDF/XML del sistema tributario)
   ‚Ä¢ Orden de Compra (si existe)
   ‚Ä¢ Gu√≠a de Remisi√≥n (si existe)
   ‚Ä¢ Historial del proveedor (score, facturas previas)
   ‚Ä¢ Impacto presupuestal del √°rea
   ‚Üì
‚úÖ APROBAR ‚Üí Pasa autom√°ticamente a cola de pago
   O
‚ùå RECHAZAR ‚Üí Sistema genera carta formal + registra en sistema tributario
   ‚Üì
‚è∞ Si NO responde en plazo configurado:
   ‚Ä¢ D√≠a X-2 ‚Üí üö® Alerta naranja
   ‚Ä¢ D√≠a X-1 ‚Üí üö®üö® Alerta roja + escalamiento a gerencia
   ‚Üì
üíæ TODO queda registrado con trazabilidad completa (auditable)
   ‚Üì
üìä Se exporta autom√°ticamente a ERP/Sistema Contable
```

---

## üí° Comparativa: Antes vs Con Fact√∫raMelo

| Situaci√≥n | ‚ùå Sin Fact√∫raMelo | ‚úÖ Con Fact√∫raMelo |
|-----------|-------------------|-------------------|
| **Cobertura** | Dependes de que te env√≠en las facturas | Obtienes TODAS directo del sistema tributario |
| **Facturas perdidas** | Quedan en bandeja de spam o email personal | Imposible perder una factura |
| **Conocimiento** | No sabes qu√© facturas te emitieron | Alertas instant√°neas de todas las emisiones |
| **Plazo legal** | Olvidas fechas l√≠mite f√°cilmente | Contador autom√°tico + alertas progresivas |
| **Fraude** | Te cobran por facturas desconocidas | Detectas y rechazas antes del plazo |
| **Validaci√≥n** | Trabajo manual horas/d√≠as | Validaci√≥n autom√°tica en segundos 24/7 |
| **Dobles pagos** | Pagas facturas duplicadas sin darte cuenta | Detector autom√°tico de duplicados |
| **Historial** | Archivos dispersos en emails y carpetas | Historial completo descargado del sistema tributario |
| **Aprobaciones** | Procesos manuales con email | Flujos automatizados con trazabilidad |
| **Presupuesto** | Control manual de gastos por √°rea | Alertas autom√°ticas de sobregiros |

---

## üéØ Casos Reales de Fraude Evitados

### **Caso 1: Fraude del Silencio (Evitado en Tiempo Real)**

**‚ùå Antes:**
1. Lunes 9:00am: Proveedor emite factura falsa por $20,000 en sistema tributario
2. Nunca te avisa - espera que pase el plazo legal
3. La factura est√° registrada oficialmente pero no lo sabes
4. Pasan 8 d√≠as ‚Üí Se acepta autom√°ticamente por ley
5. Banco/factoring te cobra ‚Üí Pierdes $20,000 üò±

**‚úÖ Con Fact√∫raMelo:**
1. Lunes 9:00am: Proveedor emite factura en sistema tributario
2. Lunes 10:00am: Fact√∫raMelo la detecta autom√°ticamente üö®
3. Lunes 10:05am: Alerta al responsable: "‚ö†Ô∏è Factura sin Orden de Compra"
4. Lunes 11:00am: Responsable revisa ‚Üí No reconoce el gasto
5. Lunes 11:30am: RECHAZA con un click
6. Sistema genera carta formal y registra rechazo en autoridad fiscal
7. **Resultado**: $20,000 protegidos üéØ

---

### **Caso 2: Factura "Fantasma"**

**‚ùå Antes:**
1. Proveedor emite factura por "consultor√≠a" nunca prestada
2. No la env√≠a por ning√∫n lado
3. Espera silenciosamente los d√≠as legales
4. T√∫ ni sabes que existe
5. Se acepta autom√°ticamente ‚Üí Te cobran

**‚úÖ Con Fact√∫raMelo:**
1. Proveedor emite en sistema tributario
2. Sistema la detecta en minutos ü§ñ
3. üö® "Nueva factura sin Orden de Compra - Acci√≥n requerida"
4. √Årea revisa ‚Üí No reconoce el servicio
5. RECHAZO inmediato antes del plazo
6. **Fraude evitado** üéØ

---

### **Caso 3: Doble Cobro**

**‚ùå Antes:**
1. Pagas factura de $15,000
2. Semanas despu√©s, proveedor la presenta otra vez
3. √Årea diferente la aprueba (no sabe que ya se pag√≥)
4. Pagas $30,000 por $15,000

**‚úÖ Con Fact√∫raMelo:**
1. Primera vez: Factura se procesa y paga normalmente
2. Intenta presentarla otra vez ‚Üí üö® "DUPLICADO DETECTADO"
3. Sistema muestra: "Ya pagado el 15/03/2025 - $15,000"
4. Autom√°ticamente bloqueado üéØ
5. **$15,000 ahorrados**

---

## üìä ROI y Ahorros

### **Ahorro Promedio Anual**
- üí∞ **$50,000 - $200,000** en fraudes evitados
- ‚è±Ô∏è **+80 horas/mes** ahorradas en procesamiento manual
- üìâ **2.5%** reducci√≥n en desembolsos por errores o duplicados
- üéØ **+35 mil millones USD** perdidos anualmente en LATAM por mal manejo de CxP (seg√∫n McKinsey)

### **Tiempo de Implementaci√≥n**
- ‚ö° Setup inicial: 2-5 d√≠as
- üîó Integraci√≥n con ERP: 1-2 semanas
- üìö Capacitaci√≥n de usuarios: 1 d√≠a
- üöÄ ROI positivo: Primer mes

---

## üåç Cobertura Geogr√°fica

### **Latinoam√©rica**
- üáµüá™ Per√∫ (SUNAT/SIRE)
- üá≤üáΩ M√©xico (SAT)
- üá®üá± Chile (SII)
- üá®üá¥ Colombia (DIAN)
- üá¶üá∑ Argentina (AFIP)
- üáßüá∑ Brasil (SEFAZ)
- üá™üá® Ecuador (SRI)
- Y m√°s pa√≠ses...

### **Europa**
- üá™üá∏ Espa√±a (AEAT)
- üáµüáπ Portugal (AT)
- üáÆüáπ Italia (AdE)
- üá´üá∑ Francia (DGFiP)
- Y m√°s pa√≠ses...

Cada pa√≠s con su integraci√≥n espec√≠fica al sistema tributario local y cumplimiento de normativas fiscales.

---

## üîê Seguridad y Cumplimiento

- üîí Cifrado end-to-end
- üèõÔ∏è Cumplimiento normativo por pa√≠s
- üìã Auditor√≠a completa de todas las acciones
- üíæ Backup autom√°tico y redundancia
- üõ°Ô∏è Protecci√≥n contra ataques y antivirus integrado
- üîë Autenticaci√≥n multi-factor (MFA)

---

## üéØ En Resumen

**Fact√∫raMelo** es la soluci√≥n definitiva para empresas de LATAM y Europa que buscan:

‚úÖ **Protecci√≥n total contra fraude** de facturas falsas
‚úÖ **Automatizaci√≥n completa** del ciclo de vida contable
‚úÖ **Cumplimiento fiscal** garantizado en cada pa√≠s
‚úÖ **Integraci√≥n perfecta** con ERPs y sistemas existentes
‚úÖ **Ahorro significativo** en tiempo y dinero
‚úÖ **Tranquilidad** de tener control total sobre tus facturas

**Ventaja Definitiva**: *"Si est√° en el sistema tributario oficial, lo sabemos de inmediato y actuamos antes del plazo legal"* üéØ
